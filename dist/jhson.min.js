"use strict";var Constant,Is,Data,DomElement;(Constant||(Constant={})).JHSON_JS_ATTRIBUTE_NAME="data-jhson-js",(e=>{function t(e){return null!=e&&""!==e.toString()}function n(e){return t(e)&&"object"==typeof e}e.defined=t,e.definedObject=n,e.definedBoolean=function(e){return t(e)&&"boolean"==typeof e},e.definedString=function(e){return t(e)&&"string"==typeof e},e.definedFunction=function(e){return t(e)&&"function"==typeof e},e.definedNumber=function(e){return t(e)&&"number"==typeof e},e.definedArray=function(e){return n(e)&&e instanceof Array}})(Is||(Is={})),(e=>{let t;var n;function r(e,t){return Is.definedArray(e)?e:t}(n=t=e.String||(e.String={})).newGuid=function(){const e=[];for(let t=0;t<32;t++){8!==t&&12!==t&&16!==t&&20!==t||e.push("-");const n=Math.floor(16*Math.random()).toString(16);e.push(n)}return e.join("")},n.startsWithAnyCase=function(e,t){return e.substring(0,t.length).toLowerCase()===t.toLowerCase()},n.replaceAll=function(e,t,n){return e.replace(new RegExp(t.replace("|","[|]"),"g"),n)},n.getTemplateVariables=function(e){const t=[];if(Is.definedString(e)){let n=0,r=0;for(;n>-1;)if(n=e.indexOf("{{",r),n>-1&&(r=e.indexOf("}}",n),r>-1)){const a=e.substring(n,r+2);t.push(a),r+=2}}return t},e.getDefaultAnyString=function(e,t){return"string"==typeof e?e:t},e.getDefaultString=function(e,t){return Is.definedString(e)?e:t},e.getDefaultBoolean=function(e,t){return Is.definedBoolean(e)?e:t},e.getDefaultNumber=function(e,t){return Is.definedNumber(e)?e:t},e.getDefaultFunction=function(e,t){return Is.definedFunction(e)?e:t},e.getDefaultArray=r,e.getDefaultObject=function(e,t){return Is.definedObject(e)?e:t},e.getDefaultStringOrArray=function(e,t){let n=t;if(Is.definedString(e)){const r=e.toString().split(" ");0===r.length?e=t:n=r}else n=r(e,t);return n}})(Data||(Data={})),(DomElement||(DomElement={})).create=function(e,t){const n=t.toLowerCase();let r="text"===n?document.createTextNode(""):document.createElement(n);return e.appendChild(r),r},(()=>{let _configuration={};function render(){const e=_configuration.domElementTypes,t=e.length;for(let n=0;n<t;n++){const t=document.getElementsByTagName(e[n]),r=[].slice.call(t),a=r.length;for(let e=0;e<a&&renderBindingElement(r[e]);e++);}}function renderBindingElement(e){let t=!0;if(Is.defined(e)&&e.hasAttribute(Constant.JHSON_JS_ATTRIBUTE_NAME)){var n=e.getAttribute(Constant.JHSON_JS_ATTRIBUTE_NAME);if(Is.definedString(n)){var r=getObjectFromString(n);r.parsed&&Is.definedObject(r.object)?renderElement(renderBindingOptions(r.object,e)):_configuration.safeMode||(console.error(_configuration.text.attributeNotValidErrorText.replace("{{attribute_name}}",Constant.JHSON_JS_ATTRIBUTE_NAME)),t=!1)}else _configuration.safeMode||(console.error(_configuration.text.attributeNotSetErrorText.replace("{{attribute_name}}",Constant.JHSON_JS_ATTRIBUTE_NAME)),t=!1)}return t}function renderBindingOptions(e,t){const n=buildAttributeOptions(e);return n._currentView.element=t,n}function renderElement(e){fireCustomTriggerEvent(e.events.onBeforeRender,e._currentView.element);const t=getDefaultHtmlProperties();t.json=e.json,writeHtml(e._currentView.element,t),fireCustomTriggerEvent(e.events.onRenderComplete,e._currentView.element)}function buildAttributeOptions(e){let t=Data.getDefaultObject(e,{});const n=getDefaultHtmlProperties();return t.json=Data.getDefaultString(t.json,n.json),t.templateData=Data.getDefaultObject(t.templateData,n.templateData),t.removeOriginalAttributes=Data.getDefaultBoolean(t.removeOriginalAttributes,n.removeOriginalAttributes),t.clearOriginalHTML=Data.getDefaultBoolean(t.clearOriginalHTML,n.clearOriginalHTML),t.addCssToHead=Data.getDefaultBoolean(t.addCssToHead,n.addCssToHead),t.clearCssFromHead=Data.getDefaultBoolean(t.clearCssFromHead,n.clearCssFromHead),t.logTemplateDataWarnings=Data.getDefaultBoolean(t.logTemplateDataWarnings,n.logTemplateDataWarnings),t.addAttributes=Data.getDefaultBoolean(t.addAttributes,n.addAttributes),t.addCssProperties=Data.getDefaultBoolean(t.addCssProperties,n.addCssProperties),t.addText=Data.getDefaultBoolean(t.addText,n.addText),t.addChildren=Data.getDefaultBoolean(t.addChildren,n.addChildren),t=buildAttributeOptionCustomTriggers(t),t}function buildAttributeOptionCustomTriggers(e){return e.events.onBeforeRender=Data.getDefaultFunction(e.events.onBeforeRender,null),e.events.onRenderComplete=Data.getDefaultFunction(e.events.onRenderComplete,null),e}function getDefaultJsonProperties(){return{includeAttributes:!0,includeCssProperties:!1,includeText:!0,includeChildren:!0,friendlyFormat:!0,indentSpaces:2,ignoreNodeTypes:[],ignoreCssProperties:[],ignoreAttributes:[],generateUniqueMissingIds:!1}}function getJSON(e,t){let n="";if(Is.definedObject(e)){const r={},a=getElementObject(e,t,{});r[a.nodeName]=a.nodeValues,n=t.friendlyFormat?JSON.stringify(r,null,t.indentSpaces):JSON.stringify(r)}return n}function getElementObject(e,t,n){const r={},a=e.children.length;let i=0;return t.includeAttributes&&getElementAttributes(e,r,t),t.includeCssProperties&&getElementCssProperties(e,r,t,n),t.includeChildren&&a>0&&(i=getElementChildren(e,r,a,t,n)),t.includeText&&getElementText(e,r,i),Is.defined(r["&children"])&&0===r["&children"].length&&delete r["&children"],{nodeName:e.nodeName.toLowerCase(),nodeValues:r}}function getElementAttributes(e,t,n){const r=e.attributes.length,a=[];if(n.includeText&&"textarea"===e.nodeName.toLowerCase()){const n=e;Is.defined(n.value)&&(t["#text"]=n.value)}for(let i=0;i<r;i++){const r=e.attributes[i];Is.definedString(r.nodeName)&&-1===n.ignoreAttributes.indexOf(r.nodeName)&&(t["@"+r.nodeName]=r.nodeValue,a.push(r.nodeName))}n.generateUniqueMissingIds&&-1===a.indexOf("id")&&-1===n.ignoreAttributes.indexOf("id")&&(t["@id"]=Data.String.newGuid())}function getElementCssProperties(e,t,n,r){const a=getComputedStyle(e),i=a.length;for(let e=0;e<i;e++){const i=a[e];if(-1===n.ignoreCssProperties.indexOf(i)){const e="$"+i,n=a.getPropertyValue(i);r.hasOwnProperty(e)&&r[e]===n||(t[e]=n,r[e]=t[e])}}}function getElementChildren(e,t,n,r,a){let i=0;t["&children"]=[];for(let o=0;o<n;o++){const n=getElementObject(e.children[o],r,getParentCssStylesCopy(a));let s=!1;if(_configuration.formattingNodeTypes.indexOf(n.nodeName)>-1?i++:-1===r.ignoreNodeTypes.indexOf(n.nodeName)&&(s=!0,i++),s){const e={};e[n.nodeName]=n.nodeValues,t["&children"].push(e)}}return i}function getElementText(e,t,n){Is.definedString(e.innerText)&&(n>0&&Is.defined(t["&children"])&&0===t["&children"].length?t["#text"]=e.innerHTML:e.innerText.trim()===e.innerHTML.trim()&&(t["#text"]=e.innerText))}function getParentCssStylesCopy(e){const t={};for(let n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function getDefaultHtmlProperties(){return{json:"",templateData:{},removeOriginalAttributes:!0,clearOriginalHTML:!0,addCssToHead:!1,clearCssFromHead:!1,logTemplateDataWarnings:!1,addAttributes:!0,addCssProperties:!0,addText:!0,addChildren:!0}}function writeHtml(e,t){if(Is.definedObject(e)&&Is.definedString(t.json)){const n=getObjectFromString(t.json),r={css:{},templateDataKeys:[],templateDataKeysLength:0,templateDataKeysProcessed:[]};if(n.parsed&&Is.definedObject(n.object)){t.clearCssFromHead&&clearCssStyleTagsFromHead(),Is.definedObject(t.templateData)&&setupWritingScopeTemplateDataKeys(t,r);for(let a in n.object)if(a===e.nodeName.toLowerCase()){if(t.removeOriginalAttributes)for(;e.attributes.length>0;)e.removeAttribute(e.attributes[0].name);t.clearOriginalHTML&&(e.innerHTML=""),writeNode(e,n.object[a],t,r)}processRemainingVariablesForDefaults(e),t.addCssToHead&&writeCssStyleTag(r),t.logTemplateDataWarnings&&checkedForUnusedTemplateData(r)}}return _public}function setupWritingScopeTemplateDataKeys(e,t){for(let n in e.templateData)e.templateData.hasOwnProperty(n)&&t.templateDataKeys.push(n);t.templateDataKeys=t.templateDataKeys.sort((function(e,t){return t.length-e.length})),t.templateDataKeysLength=t.templateDataKeys.length}function writeNode(e,t,n,r){const a=[];for(let i in t)if(Data.String.startsWithAnyCase(i,"@")){if(n.addAttributes){const n=i.replace("@",""),r=t[i];e.setAttribute(n,r)}}else if(Data.String.startsWithAnyCase(i,"$")){if(n.addCssProperties){const r=i.replace("$","");n.addCssToHead?a.push(r+":"+t[i]+";"):e.style.setProperty(r,t[i])}}else if("#text"===i)n.addText&&writeElementTextAndTemplateData(e,t[i],n,r);else if("&children"===i&&n.addChildren){const a=t[i].length;for(let o=0;o<a;o++){const a=t[i][o];for(let t in a)if(a.hasOwnProperty(t)){writeNode(DomElement.create(e,t.toLowerCase()),a[t],n,r)}}}a.length>0&&storeCssStyles(e,a,r)}function writeElementTextAndTemplateData(e,t,n,r){if(e.innerHTML=t,r.templateDataKeysLength>0)for(let t=0;t<r.templateDataKeysLength;t++){let a=r.templateDataKeys[t];if(n.templateData.hasOwnProperty(a)){const t=n.templateData[a];if(e.innerHTML.indexOf(a)>-1)e.innerHTML=Data.String.replaceAll(e.innerHTML,a,t),-1===r.templateDataKeysProcessed.indexOf(a)&&r.templateDataKeysProcessed.push(a);else{a=a.replace("}}","")+" |";const n=e.innerHTML.indexOf(a);if(n>-1){const r=e.innerHTML.indexOf("}}",n);if(r>-1){const a=e.innerHTML.substring(n,r+2);e.innerHTML=Data.String.replaceAll(e.innerHTML,a,t)}}}}}}function storeCssStyles(e,t,n){let r=null;if(Is.definedString(e.className)){const t=e.className.split(" ");r=e.nodeName.toLowerCase()+"."+t[0]+" {"}else Is.definedString(e.id)||(e.id=Data.String.newGuid()),r="#"+e.id+" {";let a=[];a.push(r),a=a.concat(t),a.push("}"),n.css[e.id]=a}function writeCssStyleTag(e){const t=document.getElementsByTagName("head")[0];let n=[];for(let t in e.css)e.css.hasOwnProperty(t)&&(n=n.concat(e.css[t]));DomElement.create(t,"style").appendChild(document.createTextNode(n.join("\n")))}function clearCssStyleTagsFromHead(){const e=[].slice.call(document.getElementsByTagName("styles")),t=e.length;for(let n=0;n<t;n++)e[n].parentNode.removeChild(e[n])}function checkedForUnusedTemplateData(e){const t=e.templateDataKeysProcessed.length;if(e.templateDataKeysLength>t)for(let t=0;t<e.templateDataKeysLength;t++){const n=e.templateDataKeys[t];-1===e.templateDataKeysProcessed.indexOf(n)&&console.warn(_configuration.text.variableWarningText.replace("{{variable_name}}",n))}}function processRemainingVariablesForDefaults(e){const t=Data.String.getTemplateVariables(e.innerHTML),n=t.length;for(let r=0;r<n;r++){const n=t[r];if(n.indexOf("|")>-1){const t=n.replace("{{","").replace("}}","").split("|")[1];Is.definedString(t)&&(e.innerHTML=e.innerHTML.replace(n,t.trim()))}}}function fireCustomTriggerEvent(e,...t){Is.definedFunction(e)&&e.apply(null,[].slice.call(t,0))}function getObjectFromString(objectString){const result={parsed:!0,object:null};try{Is.definedString(objectString)&&(result.object=JSON.parse(objectString))}catch(e1){try{result.object=eval(`(${objectString})`),Is.definedFunction(result.object)&&(result.object=result.object())}catch(e){_configuration.safeMode||(console.error(_configuration.text.objectErrorText.replace("{{error_1}}",e1.message).replace("{{error_2}}",e.message)),result.parsed=!1),result.object=null}}return result}function buildDefaultConfiguration(e=null){_configuration=Data.getDefaultObject(e,{}),_configuration.safeMode=Data.getDefaultBoolean(_configuration.safeMode,!0),_configuration.domElementTypes=Data.getDefaultStringOrArray(_configuration.domElementTypes,["*"]),_configuration.formattingNodeTypes=Data.getDefaultStringOrArray(_configuration.formattingNodeTypes,["b","strong","i","em","mark","small","del","ins","sub","sup"]),buildDefaultConfigurationStrings()}function buildDefaultConfigurationStrings(){_configuration.text.variableWarningText=Data.getDefaultString(_configuration.text.variableWarningText,"Template variable {{variable_name}} not found."),_configuration.text.objectErrorText=Data.getDefaultString(_configuration.text.objectErrorText,"Errors in object: {{error_1}}, {{error_2}}"),_configuration.text.attributeNotValidErrorText=Data.getDefaultString(_configuration.text.attributeNotValidErrorText,"The attribute '{{attribute_name}}' is not a valid object."),_configuration.text.attributeNotSetErrorText=Data.getDefaultString(_configuration.text.attributeNotSetErrorText,"The attribute '{{attribute_name}}' has not been set correctly.")}const _public={json:function(){const e=getDefaultJsonProperties();return{includeAttributes:function(t){return e.includeAttributes=Data.getDefaultBoolean(t,e.includeAttributes),this},includeCssProperties:function(t){return e.includeCssProperties=Data.getDefaultBoolean(t,e.includeCssProperties),this},includeText:function(t){return e.includeText=Data.getDefaultBoolean(t,e.includeText),this},includeChildren:function(t){return e.includeChildren=Data.getDefaultBoolean(t,e.includeChildren),this},friendlyFormat:function(t){return e.friendlyFormat=Data.getDefaultBoolean(t,e.friendlyFormat),this},indentSpaces:function(t){return e.indentSpaces=Data.getDefaultNumber(t,e.indentSpaces),this},ignoreNodeTypes:function(t){return e.ignoreNodeTypes=Data.getDefaultStringOrArray(t,e.ignoreNodeTypes),this},ignoreCssProperties:function(t){return e.ignoreCssProperties=Data.getDefaultStringOrArray(t,e.ignoreCssProperties),this},ignoreAttributes:function(t){return e.ignoreAttributes=Data.getDefaultStringOrArray(t,e.ignoreAttributes),this},generateUniqueMissingIds:function(t){return e.generateUniqueMissingIds=Data.getDefaultBoolean(t,e.generateUniqueMissingIds),this},get:function(t){return getJSON(t,e)},getVariables:function(e){return Data.String.getTemplateVariables(e)}}},html:function(){const e=getDefaultHtmlProperties(),t={json:function(n){return e.json=Data.getDefaultString(n,e.json),t},templateData:function(n){return e.templateData=Data.getDefaultObject(n,e.templateData),t},removeOriginalAttributes:function(n){return e.removeOriginalAttributes=Data.getDefaultBoolean(n,e.removeOriginalAttributes),t},clearOriginalHTML:function(n){return e.clearOriginalHTML=Data.getDefaultBoolean(n,e.clearOriginalHTML),t},addCssToHead:function(n){return e.addCssToHead=Data.getDefaultBoolean(n,e.addCssToHead),t},clearCssFromHead:function(n){return e.clearCssFromHead=Data.getDefaultBoolean(n,e.clearCssFromHead),t},logTemplateDataWarnings:function(n){return e.logTemplateDataWarnings=Data.getDefaultBoolean(n,e.logTemplateDataWarnings),t},addAttributes:function(n){return e.addAttributes=Data.getDefaultBoolean(n,e.addAttributes),t},addCssProperties:function(n){return e.addCssProperties=Data.getDefaultBoolean(n,e.addCssProperties),t},addText:function(n){return e.addText=Data.getDefaultBoolean(n,e.addText),t},addChildren:function(n){return e.addChildren=Data.getDefaultBoolean(n,e.addChildren),t},write:function(t){return writeHtml(t,e)},getVariables:function(e){let t=[];return Is.definedObject(e)&&(t=Data.String.getTemplateVariables(e.innerHTML)),t}};return t},setConfiguration:function(e){if(Is.definedObject(e)){let t=!1;const n=_configuration;for(let r in e)e.hasOwnProperty(r)&&_configuration.hasOwnProperty(r)&&n[r]!==e[r]&&(n[r]=e[r],t=!0);t&&buildDefaultConfiguration(n)}return _public},getVersion:function(){return"2.0.0"}};buildDefaultConfiguration(),document.addEventListener("DOMContentLoaded",(function(){render()})),Is.defined(window.$jhson)||(window.$jhson=_public)})();