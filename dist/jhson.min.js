"use strict";var Constant,Is,Default2,DomElement,Str,Str2,Config,Binding,Trigger;(Constant||(Constant={})).JHSON_JS_ATTRIBUTE_NAME="data-jhson-js",(e=>{function t(e){return null!=e&&""!==e.toString()}function n(e){return t(e)&&"object"==typeof e}e.defined=t,e.definedObject=n,e.definedBoolean=function(e){return t(e)&&"boolean"==typeof e},e.definedString=function(e){return t(e)&&"string"==typeof e},e.definedFunction=function(e){return t(e)&&"function"==typeof e},e.definedNumber=function(e){return t(e)&&"number"==typeof e},e.definedArray=function(e){return n(e)&&e instanceof Array}})(Is||(Is={})),(Default=>{function getString(e,t){return Is.definedString(e)?e:t}function getBoolean(e,t){return Is.definedBoolean(e)?e:t}function getNumber(e,t){return Is.definedNumber(e)?e:t}function getFunction(e,t){return Is.definedFunction(e)?e:t}function getArray(e,t){return Is.definedArray(e)?e:t}function getObject(e,t){return Is.definedObject(e)?e:t}function getStringOrArray(e,t){let n=t;if(Is.definedString(e)){const r=e.toString().split(" ");0===r.length?e=t:n=r}else n=getArray(e,t);return n}function getObjectFromString(objectString,configuration){const result={parsed:!0,object:null};try{Is.definedString(objectString)&&(result.object=JSON.parse(objectString))}catch(e1){try{result.object=eval(`(${objectString})`),Is.definedFunction(result.object)&&(result.object=result.object())}catch(e){configuration.safeMode||(console.error(configuration.text.objectErrorText.replace("{{error_1}}",e1.message).replace("{{error_2}}",e.message)),result.parsed=!1),result.object=null}}return result}Default.getString=getString,Default.getBoolean=getBoolean,Default.getNumber=getNumber,Default.getFunction=getFunction,Default.getArray=getArray,Default.getObject=getObject,Default.getStringOrArray=getStringOrArray,Default.getObjectFromString=getObjectFromString})(Default2||(Default2={})),(e=>{function t(e){const t=e.toLowerCase();return"text"===t?document.createTextNode(""):document.createElement(t)}e.create=function(e,n){let r=t(n);return e.appendChild(r),r},e.createWithNoContainer=t})(DomElement||(DomElement={})),Str2=Str||(Str={}),Str2.startsWithAnyCase=function(e,t){return e.substring(0,t.length).toLowerCase()===t.toLowerCase()},Str2.replaceAll=function(e,t,n){return e.replace(new RegExp(t.replace("|","[|]"),"g"),n)},Str2.getTemplateVariables=function(e){const t=[];if(Is.definedString(e)){let n=0,r=0;for(;n>-1;)if(n=e.indexOf("{{",r),n>-1&&(r=e.indexOf("}}",n),r>-1)){const a=e.substring(n,r+2);t.push(a),r+=2}}return t},(e=>{let t;(t=e.Options||(e.Options={})).get=function(e=null){let t=Default2.getObject(e,{});return t.safeMode=Default2.getBoolean(t.safeMode,!0),t.domElementTypes=Default2.getStringOrArray(t.domElementTypes,["*"]),t.formattingNodeTypes=Default2.getStringOrArray(t.formattingNodeTypes,["b","strong","i","em","mark","small","del","ins","sub","sup"]),t=function(e){return e.text=Default2.getObject(e.text,{}),e.text.variableWarningText=Default2.getString(e.text.variableWarningText,"Template variable {{variable_name}} not found."),e.text.objectErrorText=Default2.getString(e.text.objectErrorText,"Errors in object: {{error_1}}, {{error_2}}"),e.text.attributeNotValidErrorText=Default2.getString(e.text.attributeNotValidErrorText,"The attribute '{{attribute_name}}' is not a valid object."),e.text.attributeNotSetErrorText=Default2.getString(e.text.attributeNotSetErrorText,"The attribute '{{attribute_name}}' has not been set correctly."),e}(t),t}})(Config||(Config={})),(e=>{let t;(e=>{function t(e,t){let n=Default2.getObject(e,{});return n.json=Default2.getString(n.json,t.json),n.templateData=Default2.getObject(n.templateData,t.templateData),n.removeOriginalAttributes=Default2.getBoolean(n.removeOriginalAttributes,t.removeOriginalAttributes),n.removeOriginalDataAttributes=Default2.getBoolean(n.removeOriginalDataAttributes,t.removeOriginalDataAttributes),n.clearOriginalHTML=Default2.getBoolean(n.clearOriginalHTML,t.clearOriginalHTML),n.addCssToHead=Default2.getBoolean(n.addCssToHead,t.addCssToHead),n.clearCssFromHead=Default2.getBoolean(n.clearCssFromHead,t.clearCssFromHead),n.logTemplateDataWarnings=Default2.getBoolean(n.logTemplateDataWarnings,t.logTemplateDataWarnings),n.addAttributes=Default2.getBoolean(n.addAttributes,t.addAttributes),n.addDataAttributes=Default2.getBoolean(n.addDataAttributes,t.addDataAttributes),n.addCssProperties=Default2.getBoolean(n.addCssProperties,t.addCssProperties),n.addText=Default2.getBoolean(n.addText,t.addText),n.addChildren=Default2.getBoolean(n.addChildren,t.addChildren),n.insertBefore=Default2.getBoolean(n.insertBefore,t.insertBefore),n=function(e){return e.events=Default2.getObject(e.events,{}),e.events.onBeforeRender=Default2.getFunction(e.events.onBeforeRender,null),e.events.onRenderComplete=Default2.getFunction(e.events.onRenderComplete,null),e}(n),n}e.getForNewInstance=function(e,n,r){const a=t(e,r);return a._currentView={},a._currentView.element=n,a},e.get=t})(t=e.Options||(e.Options={}))})(Binding||(Binding={})),(Trigger||(Trigger={})).customEvent=function(e,...t){Is.definedFunction(e)&&e.apply(null,[].slice.call(t,0))},(()=>{let e={};function t(t){let n=!0;if(Is.defined(t)&&t.hasAttribute(Constant.JHSON_JS_ATTRIBUTE_NAME)){let r=t.getAttribute(Constant.JHSON_JS_ATTRIBUTE_NAME);if(Is.definedString(r)){const a=Default2.getObjectFromString(r,e);a.parsed&&Is.definedObject(a.object)?function(e){Trigger.customEvent(e.events.onBeforeRender,e._currentView.element);const t=i(e);o(e._currentView.element,t),Trigger.customEvent(e.events.onRenderComplete,e._currentView.element)}(Binding.Options.getForNewInstance(a.object,t,i())):e.safeMode||(console.error(e.text.attributeNotValidErrorText.replace("{{attribute_name}}",Constant.JHSON_JS_ATTRIBUTE_NAME)),n=!1)}else e.safeMode||(console.error(e.text.attributeNotSetErrorText.replace("{{attribute_name}}",Constant.JHSON_JS_ATTRIBUTE_NAME)),n=!1)}return n}function n(t,i,o){const s={},l=t.children.length;let u=0;return i.includeAttributes&&function(e,t,n){const a=e.attributes.length,i=[];if(n.includeText&&"textarea"===e.nodeName.toLowerCase()){const n=e;Is.defined(n.value)&&(t["#text"]=n.value)}for(let o=0;o<a;o++){const a=e.attributes[o];if(Is.definedString(a.nodeName)&&-1===n.ignoreAttributes.indexOf(a.nodeName)&&(n.includeDataAttributes||!a.nodeName.startsWith("data-"))){const o=`@${a.nodeName}`;"img"===e.nodeName.toLowerCase()&&"src"===a.nodeName&&n.includeImagesAsBase64?t[o]=r(e):t[o]=a.nodeValue,i.push(a.nodeName)}}n.generateUniqueMissingIds&&-1===i.indexOf("id")&&-1===n.ignoreAttributes.indexOf("id")&&(t["@id"]=crypto.randomUUID());n.generateUniqueMissingNames&&-1===i.indexOf("name")&&-1===n.ignoreAttributes.indexOf("name")&&(t["@name"]=crypto.randomUUID())}(t,s,i),i.includeCssProperties&&function(e,t,n,r){const a=getComputedStyle(e),i=a.length;for(let e=0;e<i;e++){const i=a[e];if(-1===n.ignoreCssProperties.indexOf(i)){const e=`$${i}`,n=a.getPropertyValue(i);r.hasOwnProperty(e)&&r[e]===n||(t[e]=n,r[e]=t[e])}}}(t,s,i,o),i.includeChildren&&l>0&&(u=function(t,r,i,o,s){let l=0;r["&children"]=[];for(let u=0;u<i;u++){const i=t.children[u],d=n(i,o,a(s));let c=!1;if(e.formattingNodeTypes.indexOf(d.nodeName)>-1?l++:-1===o.ignoreNodeTypes.indexOf(d.nodeName)&&(Is.definedFunction(o.ignoreNodeCondition)&&o.ignoreNodeCondition(i)||(c=!0,l++)),c){const e={};e[d.nodeName]=d.nodeValues,r["&children"].push(e)}}return l}(t,s,l,i,o)),i.includeText&&function(e,t,n){Is.definedString(e.innerText)&&(n>0&&t.hasOwnProperty("&children")&&0===t["&children"].length?t["#text"]=e.innerHTML:e.innerText.trim()===e.innerHTML.trim()&&(t["#text"]=e.innerText))}(t,s,u),s.hasOwnProperty("&children")&&0===s["&children"].length&&delete s["&children"],{nodeName:t.nodeName.toLowerCase(),nodeValues:s}}function r(e){const t=DomElement.createWithNoContainer("canvas");t.width=e.width,t.height=e.height;t.getContext("2d").drawImage(e,0,0);return t.toDataURL()}function a(e){const t={};for(let n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function i(e=null){const t=Is.definedObject(e);return{json:t?e.json:"",templateData:t?e.templateData:{},removeOriginalAttributes:!t||e.removeOriginalAttributes,removeOriginalDataAttributes:!t||e.removeOriginalDataAttributes,clearOriginalHTML:!t||e.clearOriginalHTML,addCssToHead:!!t&&e.addCssToHead,clearCssFromHead:!!t&&e.clearCssFromHead,logTemplateDataWarnings:!!t&&e.logTemplateDataWarnings,addAttributes:!t||e.addAttributes,addDataAttributes:!t||e.addDataAttributes,addCssProperties:!t||e.addCssProperties,addText:!t||e.addText,addChildren:!t||e.addChildren,insertBefore:!!t&&e.insertBefore}}function o(t,n,r=null){if(Is.definedObject(t)&&Is.definedString(n.json)){let a=r;Is.definedObject(a)||(a=Default2.getObjectFromString(n.json,e));const i={css:{},templateDataKeys:[],templateDataKeysLength:0,templateDataKeysProcessed:[]};if(a.parsed&&Is.definedObject(a.object)){n.clearCssFromHead&&function(){const e=[].slice.call(document.getElementsByTagName("styles")),t=e.length;for(let n=0;n<t;n++)e[n].parentNode.removeChild(e[n])}(),Is.definedObject(n.templateData)&&function(e,t){for(let n in e.templateData)e.templateData.hasOwnProperty(n)&&t.templateDataKeys.push(n);t.templateDataKeys=t.templateDataKeys.sort((function(e,t){return t.length-e.length})),t.templateDataKeysLength=t.templateDataKeys.length}(n,i);for(let e in a.object)if(e===t.nodeName.toLowerCase()){let r=null;if(n.removeOriginalAttributes){let e=t.attributes.length;for(;e>0;){const r=t.attributes[0].name;!n.removeOriginalDataAttributes&&r.startsWith("data-")||t.removeAttribute(r),e--}}n.clearOriginalHTML?t.innerHTML="":n.insertBefore&&t.children.length>0&&(r=t.children[0]),s(t,a.object[e],n,i,r);break}!function(e){const t=Str.getTemplateVariables(e.innerHTML),n=t.length;for(let r=0;r<n;r++){const n=t[r];if(n.indexOf("|")>-1){const t=n.replace("{{","").replace("}}","").split("|")[1];Is.definedString(t)&&(e.innerHTML=e.innerHTML.replace(n,t.trim()))}}}(t),n.addCssToHead&&function(e){const t=document.getElementsByTagName("head")[0];let n=[];for(let t in e.css)e.css.hasOwnProperty(t)&&(n=n.concat(e.css[t]));DomElement.create(t,"style").appendChild(document.createTextNode(n.join("\n")))}(i),n.logTemplateDataWarnings&&function(t){const n=t.templateDataKeysProcessed.length;if(t.templateDataKeysLength>n)for(let n=0;n<t.templateDataKeysLength;n++){const r=t.templateDataKeys[n];-1===t.templateDataKeysProcessed.indexOf(r)&&console.warn(e.text.variableWarningText.replace("{{variable_name}}",r))}}(i)}}return u}function s(e,t,n,r,a){const i=[];for(let a in t)if(Str.startsWithAnyCase(a,"@")){if(n.addAttributes){const r=a.replace("@","");if(n.addDataAttributes||!r.startsWith("data-")){const n=t[a];e.setAttribute(r,n)}}}else if(Str.startsWithAnyCase(a,"$")){if(n.addCssProperties){const r=a.replace("$","");n.addCssToHead?i.push(`${r}:${t[a]};`):e.style.setProperty(r,t[a])}}else if("#text"===a)n.addText&&l(e,t[a],n,r);else if("&children"===a&&n.addChildren){const i=t[a].length;for(let o=0;o<i;o++){const i=t[a][o];for(let t in i)if(i.hasOwnProperty(t)){s(DomElement.create(e,t.toLowerCase()),i[t],n,r,null)}}}i.length>0&&function(e,t,n){let r=null;if(Is.definedString(e.className)){const t=e.className.split(" ");r=`${e.nodeName.toLowerCase()}.${t[0]} {`}else Is.definedString(e.id)||(e.id=crypto.randomUUID()),r=`#${e.id} {`;let a=[];a.push(r),a=a.concat(t),a.push("}"),n.css[e.id]=a}(e,i,r)}function l(e,t,n,r){if(e.innerHTML=t,r.templateDataKeysLength>0)for(let t=0;t<r.templateDataKeysLength;t++){let a=r.templateDataKeys[t];if(n.templateData.hasOwnProperty(a)){const t=n.templateData[a];if(e.innerHTML.indexOf(a)>-1)e.innerHTML=Str.replaceAll(e.innerHTML,a,t),-1===r.templateDataKeysProcessed.indexOf(a)&&r.templateDataKeysProcessed.push(a);else{a=`${a.replace("}}","")} |`;const n=e.innerHTML.indexOf(a);if(n>-1){const r=e.innerHTML.indexOf("}}",n);if(r>-1){const a=e.innerHTML.substring(n,r+2);e.innerHTML=Str.replaceAll(e.innerHTML,a,t)}}}}}}const u={json:function(){const e={includeAttributes:!0,includeDataAttributes:!0,includeCssProperties:!1,includeText:!0,includeChildren:!0,includeImagesAsBase64:!1,friendlyFormat:!0,indentSpaces:2,ignoreNodeTypes:[],ignoreNodeCondition:null,ignoreCssProperties:[],ignoreAttributes:[],generateUniqueMissingIds:!1,generateUniqueMissingNames:!1,propertyReplacer:null};return{includeAttributes:function(t){return e.includeAttributes=Default2.getBoolean(t,e.includeAttributes),this},includeDataAttributes:function(t){return e.includeDataAttributes=Default2.getBoolean(t,e.includeDataAttributes),this},includeCssProperties:function(t){return e.includeCssProperties=Default2.getBoolean(t,e.includeCssProperties),this},includeText:function(t){return e.includeText=Default2.getBoolean(t,e.includeText),this},includeChildren:function(t){return e.includeChildren=Default2.getBoolean(t,e.includeChildren),this},includeImagesAsBase64:function(t){return e.includeImagesAsBase64=Default2.getBoolean(t,e.includeImagesAsBase64),this},friendlyFormat:function(t){return e.friendlyFormat=Default2.getBoolean(t,e.friendlyFormat),this},indentSpaces:function(t){return e.indentSpaces=Default2.getNumber(t,e.indentSpaces),this},ignoreNodeTypes:function(t){return e.ignoreNodeTypes=Default2.getStringOrArray(t,e.ignoreNodeTypes),this},ignoreNodeCondition:function(t){return e.ignoreNodeCondition=Default2.getFunction(t,e.ignoreNodeCondition),this},ignoreCssProperties:function(t){return e.ignoreCssProperties=Default2.getStringOrArray(t,e.ignoreCssProperties),this},ignoreAttributes:function(t){return e.ignoreAttributes=Default2.getStringOrArray(t,e.ignoreAttributes),this},generateUniqueMissingIds:function(t){return e.generateUniqueMissingIds=Default2.getBoolean(t,e.generateUniqueMissingIds),this},generateUniqueMissingNames:function(t){return e.generateUniqueMissingNames=Default2.getBoolean(t,e.generateUniqueMissingNames),this},propertyReplacer:function(t){return e.propertyReplacer=Default2.getFunction(t,e.propertyReplacer),this},get:function(t){return function(e,t){let r="";if(Is.definedObject(e)){const a={},i=n(e,t,{});a[i.nodeName]=i.nodeValues,r=t.friendlyFormat?JSON.stringify(a,t.propertyReplacer,t.indentSpaces):JSON.stringify(a,t.propertyReplacer)}return r}(t,e)},getVariables:function(e){return Str.getTemplateVariables(e)}}},html:function(){const t=i(),n={json:function(e){return t.json=Default2.getString(e,t.json),n},templateData:function(e){return t.templateData=Default2.getObject(e,t.templateData),n},removeOriginalAttributes:function(e){return t.removeOriginalAttributes=Default2.getBoolean(e,t.removeOriginalAttributes),n},removeOriginalDataAttributes:function(e){return t.removeOriginalDataAttributes=Default2.getBoolean(e,t.removeOriginalDataAttributes),n},clearOriginalHTML:function(e){return t.clearOriginalHTML=Default2.getBoolean(e,t.clearOriginalHTML),n},addCssToHead:function(e){return t.addCssToHead=Default2.getBoolean(e,t.addCssToHead),n},clearCssFromHead:function(e){return t.clearCssFromHead=Default2.getBoolean(e,t.clearCssFromHead),n},logTemplateDataWarnings:function(e){return t.logTemplateDataWarnings=Default2.getBoolean(e,t.logTemplateDataWarnings),n},addAttributes:function(e){return t.addAttributes=Default2.getBoolean(e,t.addAttributes),n},addDataAttributes:function(e){return t.addDataAttributes=Default2.getBoolean(e,t.addDataAttributes),n},addCssProperties:function(e){return t.addCssProperties=Default2.getBoolean(e,t.addCssProperties),n},addText:function(e){return t.addText=Default2.getBoolean(e,t.addText),n},addChildren:function(e){return t.addChildren=Default2.getBoolean(e,t.addChildren),n},insertBefore:function(e){return t.insertBefore=Default2.getBoolean(e,t.insertBefore),n},write:function(e){return o(e,t)},get:function(){return function(t){let n=null;if(Is.definedString(t.json)){const r=Default2.getObjectFromString(t.json,e);for(let e in r.object){n=DomElement.createWithNoContainer(e);break}Is.defined(n)&&o(n,t,r)}return n}(t)},getVariables:function(e){let t=[];return Is.definedObject(e)&&(t=Str.getTemplateVariables(e.innerHTML)),t}};return n},setConfiguration:function(t){if(Is.definedObject(t)){let n=!1;const r=e;for(let a in t)t.hasOwnProperty(a)&&e.hasOwnProperty(a)&&r[a]!==t[a]&&(r[a]=t[a],n=!0);n&&(e=Config.Options.get(r))}return u},getVersion:function(){return"2.3.0"}};e=Config.Options.get(),document.addEventListener("DOMContentLoaded",(()=>function(){const n=e.domElementTypes,r=n.length;for(let e=0;e<r;e++){const r=document.getElementsByTagName(n[e]),a=[].slice.call(r),i=a.length;for(let e=0;e<i&&t(a[e]);e++);}}())),Is.defined(window.$jhson)||(window.$jhson=u)})();